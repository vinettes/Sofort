<?xml version = '1.0' encoding = 'UTF-8'?>
<PackageOracle class="oracle.dbtools.crest.model.design.storage.oracle.PackageOracle" name="SOFRT_JOURNAL_PKG" directorySegmentName="seg_0" id="716DF8EE-46CA-5CCA-B451-FB3F63E904EC">
<sourceConnName>sofrt@xe</sourceConnName>
<sourceObjSchema>SOFRT</sourceObjSchema>
<sourceObjName>SOFRT_JOURNAL_PKG</sourceObjName>
<createdBy>VinetteS</createdBy>
<createdTime>2016-07-15 17:29:34 UTC</createdTime>
<ownerDesignName>Sofort</ownerDesignName>
<owner>934EA447-22B6-861E-9365-357E32EDC285</owner>
<source>CREATE OR REPLACE PACKAGE SOFRT.SOFRT_JOURNAL_PKG IS&lt;br/&gt;  --&lt;br/&gt;  --  Declaring public variables.&lt;br/&gt;  IS_DELETING  CONSTANT VARCHAR2(3):= &apos;DEL&apos;;&lt;br/&gt;  IS_INSERTING CONSTANT VARCHAR2(3):= &apos;INS&apos;;&lt;br/&gt;  IS_UPDATING  CONSTANT VARCHAR2(3):= &apos;UPD&apos;; &lt;br/&gt;  --&lt;br/&gt;  --  Journal procedure for the payments table.&lt;br/&gt;  procedure sofort_pmt_gwy_resp_jn_prc (&lt;br/&gt;     p_process   IN VARCHAR2&lt;br/&gt;    ,p_rec       IN sofort_pmt_gwy_responses_jn%ROWTYPE&lt;br/&gt;    ,p_err_code  OUT NOCOPY NUMBER&lt;br/&gt;    ,p_err_msg   OUT NOCOPY VARCHAR2); &lt;br/&gt;  --&lt;br/&gt;END sofrt_journal_pkg;</source>
<body class="oracle.dbtools.crest.model.design.storage.oracle.PackageBodyOracle" name="SOFRT_JOURNAL_PKG" id="716DF8EE-46CA-5CCA-B451-FB3F63E904EC">
<sourceConnName>sofrt@xe</sourceConnName>
<sourceObjSchema>SOFRT</sourceObjSchema>
<sourceObjName>SOFRT_JOURNAL_PKG</sourceObjName>
<createdBy>VinetteS</createdBy>
<createdTime>2016-07-15 17:29:34 UTC</createdTime>
<ownerDesignName>Sofort</ownerDesignName>
<owner>934EA447-22B6-861E-9365-357E32EDC285</owner>
<source>CREATE OR REPLACE PACKAGE BODY SOFRT.SOFRT_JOURNAL_PKG IS&lt;br/&gt;  --&lt;br/&gt;  /******************************************************************************&lt;br/&gt;     NAME:       sofrt_JOURNAL_PKG&lt;br/&gt;     PURPOSE:    Manages journaling tables for sofort DB&lt;br/&gt;&lt;br/&gt;     REVISIONS:&lt;br/&gt;     Ver        	Date       	Author         	Description&lt;br/&gt;     ---------  	----------	---------------	--------------------------&lt;br/&gt;     1.0        	2015-11-10  SVinette     	  1. Created this package.&lt;br/&gt;  ******************************************************************************/&lt;br/&gt;  --&lt;br/&gt;  -- Declaring variables.&lt;br/&gt;  FIRST_STATEMENT       CONSTANT VARCHAR2(2):= &apos;S1&apos;;&lt;br/&gt;  SECOND_STATEMENT      CONSTANT VARCHAR2(2):= &apos;S2&apos;;&lt;br/&gt;  NO_ERROR_STATUS       CONSTANT PLS_INTEGER:= 0;&lt;br/&gt;  ERROR_FIRST_STATUS    CONSTANT PLS_INTEGER:= 1;&lt;br/&gt;  ERROR_SECOND_STATUS   CONSTANT PLS_INTEGER:= 2;&lt;br/&gt;  --&lt;br/&gt;  -- Sub-Program Units&lt;br/&gt;  procedure sofort_pmt_gwy_resp_jn_prc (&lt;br/&gt;     p_process     IN VARCHAR2&lt;br/&gt;    ,p_rec         IN sofort_pmt_gwy_responses_jn%rowtype&lt;br/&gt;    ,p_err_code    OUT NOCOPY NUMBER&lt;br/&gt;    ,p_err_msg     OUT NOCOPY VARCHAR2&lt;br/&gt;  )&lt;br/&gt;  IS&lt;br/&gt;    lStmt      VARCHAR2 (2);&lt;br/&gt;    lErrCode   pls_integer;&lt;br/&gt;    PROC_NAME  CONSTANT VARCHAR2(30):= &apos;SOFORT_PMT_GWY_RESP_JN_PRC&apos;;&lt;br/&gt;    TAB_NAME   CONSTANT VARCHAR2(30):= &apos;SOFORT_PMT_GWY_RESPONSES_JN&apos;;&lt;br/&gt;  BEGIN&lt;br/&gt;    p_err_code := NO_ERROR_STATUS;&lt;br/&gt;    p_err_msg := NULL;&lt;br/&gt;    --&lt;br/&gt;    IF p_process IN (IS_UPDATING, IS_DELETING) THEN&lt;br/&gt;      lStmt    := FIRST_STATEMENT;&lt;br/&gt;      lErrCode := ERROR_FIRST_STATUS;&lt;br/&gt;      --&lt;br/&gt;      UPDATE sofort_pmt_gwy_responses_jn&lt;br/&gt;      SET    to_date = p_rec.from_date - (INTERVAL &apos;0.000001&apos; SECOND)&lt;br/&gt;      WHERE  internal_id = p_rec.internal_id&lt;br/&gt;      AND    to_date     IS NULL;&lt;br/&gt;    END IF;&lt;br/&gt;    --&lt;br/&gt;    IF p_process IN (IS_INSERTING, IS_UPDATING) THEN&lt;br/&gt;      lStmt    := SECOND_STATEMENT;&lt;br/&gt;      lErrCode := ERROR_SECOND_STATUS;&lt;br/&gt;      --&lt;br/&gt;      INSERT INTO sofort_pmt_gwy_responses_jn &lt;br/&gt;          ( internal_id, id, sofort_id, result_code, description, &lt;br/&gt;            payment_type, modified_by, ogg_key_id, from_date, to_date )&lt;br/&gt;        VALUES &lt;br/&gt;          ( p_rec.internal_id, p_rec.id, p_rec.sofort_id, p_rec.result_code, p_rec.description, &lt;br/&gt;            p_rec.payment_type, p_rec.modified_by, rawtohex(sys_guid()), p_rec.from_date, null );&lt;br/&gt;    END IF;&lt;br/&gt;    --&lt;br/&gt;  EXCEPTION&lt;br/&gt;    WHEN OTHERS THEN&lt;br/&gt;      p_err_code := lErrCode;&lt;br/&gt;      p_err_msg  := PROC_NAME||&apos;, INTERNAL_ID &apos;||p_rec.internal_id||&apos;, stmt &apos;||lStmt||&apos;, &apos;||SQLERRM;&lt;br/&gt;  END sofort_pmt_gwy_resp_jn_prc;		&lt;br/&gt;  --	&lt;br/&gt;  -- PL/SQL Block&lt;br/&gt;END sofrt_journal_pkg;</source>
</body>
</PackageOracle>